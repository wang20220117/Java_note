# 什么是缓存

 ![image-20241212112458508](D:\md_image\image-20241212112458508.png)

![image-20241212112824011](D:\md_image\image-20241212112824011.png)

* 数据的==一致性问题==
* 代码维护成本
* 运维成本



# 添加商户 Redis缓存

![image-20241212211121002](D:\md_image\image-20241212211121002.png)



![image-20241212214952915](D:\md_image\image-20241212214952915.png)

```java
==三层架构对应的类==
    
[表现层]
   - Controller 类          <===> 调用
   - DTO 类（数据传输对象）

[业务逻辑层]
   - Service 接口和实现类    <===> 调用
   - VO 类（值对象）

[数据访问层]
   - Repository / DAO 接口   <===> 数据交互
   - Entity 类（实体类）

```

# 缓存更新策略

![image-20241215205023033](D:\md_image\image-20241215205023033.png)

![image-20241215205502640](D:\md_image\image-20241215205502640.png)

缓存辅助模式

![image-20241215210804536](D:\md_image\image-20241215210804536.png)

两种方案都可能发生线程的安全问题：

![image-20241215211324319](D:\md_image\image-20241215211324319.png)

方案2的异常情况的概率低。

![image-20241215211613423](D:\md_image\image-20241215211613423.png)



# 缓存穿透

![image-20241216212502228](D:\md_image\image-20241216212502228.png)

 布隆过滤：

 ![image-20241216212619236](D:\md_image\image-20241216212619236.png)

 ![image-20241216213740864](D:\md_image\image-20241216213740864.png)

 ![image-20241216214729178](D:\md_image\image-20241216214729178.png)

![image-20241216220332680](D:\md_image\image-20241216220332680.png)



# 缓存雪崩

![image-20241216220948439](D:\md_image\image-20241216220948439.png)

# 缓存击穿

![image-20241217112746106](D:\md_image\image-20241217112746106.png)

## 互斥锁

![image-20241217112852489](D:\md_image\image-20241217112852489.png)

![image-20241217144331270](D:\md_image\image-20241217144331270.png)

使用setnx来实现互斥锁



## 逻辑过期

![image-20241217143649153](D:\md_image\image-20241217143649153.png)



![image-20241217162908853](D:\md_image\image-20241217162908853.png)



## 对比

![image-20241217143808600](D:\md_image\image-20241217143808600.png)



# 缓存工具封装

![image-20241217200911872](D:\md_image\image-20241217200911872.png)



# 缓存总结

【黑马程序员Redis入门到实战教程，深度透析redis底层原理+redis分布式锁+企业解决方案+黑马点评实战项目】https://www.bilibili.com/video/BV1cr4y1671t?p=47&vd_source=4a77fee2f32e0e49d9c215eb9540c2de
