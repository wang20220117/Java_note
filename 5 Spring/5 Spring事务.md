[TOC]



# spring事务简介

![image-20241031201522756](.assets/image-20241031201522756.png)

使一起的两个事务同成功或者同失败。



步骤：

1. 在业务层 **接口**上添加Spring事务管理。

 ![image-20241103163127593](.assets/image-20241103163127593.png)

 ![image-20241103163135823](.assets/image-20241103163135823.png)

2. 设置事务管理器

 ![image-20241103163342229](.assets/image-20241103163342229-173702293019952.png)

3. 开启注解式事务驱动

 ![image-20241103163419473](.assets/image-20241103163419473.png)

# spring事务角色

 ![image-20241103163840936](.assets/image-20241103163840936.png)

 ![image-20241103164008097](.assets/image-20241103164008097.png)

# spring属性

 ![image-20241103164235618](.assets/image-20241103164235618.png)

可以在注解中开启



重点 `rollbackFor` ：

有些异常默认不会回滚事务，需要手动在注解中加入：

 ![image-20241103164758469](.assets/image-20241103164758469.png)

# 事务传播行为

 ![image-20241103170320536](.assets/image-20241103170320536.png)

将日志功能放到另一个事务中，从而方式转账失败但事务没记录的情况。

 ![image-20241103170416757](.assets/image-20241103170416757.png)

使用属性中的propagation 来设置事务的传播行为。

 ![image-20241103170802881](.assets/image-20241103170802881.png)



 ![image-20241103170921017](.assets/image-20241103170921017.png)